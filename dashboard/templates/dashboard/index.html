{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Visualization Dashboard</title>

    <!-- Bootstrap and Google Fonts -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />

    <!-- D3.js and Plotly.js for visualizations -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <!-- Custom CSS and JS -->
    <script src="{% static 'dashboard/index.js' %}"></script>
    <link href="{% static 'dashboard/style.css' %}" rel="stylesheet" />
</head>

<body>
    <!-- Container for Dashboard Elements -->
    <div class="container-fluid">
        <h1 class="text-center my-4">Data Visualization Dashboard</h1>

        <!-- Filters Section -->
        <div class="row mb-4">
            <div class="col-md-3">
                <label for="endYearFilter">End Year:</label>
                <select id="endYearFilter" class="form-control">
                    <option value="">All Years</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="topicFilter">Topic:</label>
                <select id="topicFilter" class="form-control">
                    <option value="">All Topics</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="sectorFilter">Sector:</label>
                <select id="sectorFilter" class="form-control">
                    <option value="">All Sectors</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="regionFilter">Region:</label>
                <select id="regionFilter" class="form-control">
                    <option value="">All Regions</option>
                </select>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-3">
                <label for="pestFilter">PEST:</label>
                <select id="pestFilter" class="form-control">
                    <option value="">All PEST</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="sourceFilter">Source:</label>
                <select id="sourceFilter" class="form-control">
                    <option value="">All Sources</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="swotFilter">SWOT:</label>
                <select id="swotFilter" class="form-control">
                    <option value="">All SWOT</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="countryFilter">Country:</label>
                <select id="countryFilter" class="form-control">
                    <option value="">All Countries</option>
                </select>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-3 d-flex align-items-end">
                <button id="applyFilters" class="btn btn-warning w-100">
                    Apply Filters
                </button>
            </div>
        </div>

        <!-- Key Performance Indicators (KPIs) -->
        <div class="row text-center mb-4">
            <div class="col-md-3">
                <div class="card kpi-card">
                    <div class="card-body">
                        <h5 class="card-title">Total Entries</h5>
                        <p class="card-text" id="totalEntries">0</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card kpi-card">
                    <div class="card-body">
                        <h5 class="card-title">Average Likelihood</h5>
                        <p class="card-text" id="avgLikelihood">0</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card kpi-card">
                    <div class="card-body">
                        <h5 class="card-title">Average Intensity</h5>
                        <p class="card-text" id="avgIntensity">0</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card kpi-card">
                    <div class="card-body">
                        <h5 class="card-title">Total Regions</h5>
                        <p class="card-text" id="totalRegions">0</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Graphs -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header text-center">
                        Impact vs Likelihood by Sector
                    </div>
                    <div class="card-body">
                        <div id="bubbleChart" class="chart"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card">
                    <div class="card-header text-center">
                        Relevance Over Time by Topic
                    </div>
                    <div class="card-body">
                        <div id="barChartRelevance" class="chart"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card">
                    <div class="card-header text-center">Top 5 Countries by Impact</div>
                    <div class="card-body">
                        <div id="barChartCountries" class="chart"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">Intensity Distribution</div>
                    <div class="card-body">
                        <svg id="d3Chart" width="600" height="400"></svg>
                    </div>
                </div>
            </div>

            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">Likelihood Distribution by Topic</div>
                    <div class="card-body d-flex justify-content-center align-items-center">
                        <div id="donutChart" class="chart"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">Intensity by Topic</div>
                    <div class="card-body d-flex justify-content-center align-items-center">
                        <div id="barChart" class="chart"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header text-center">Distribution by Region</div>
                    <div class="card-body">
                        <div id="DistdonutChart" class="chart"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">Intensity vs Relevance</div>
                    <div class="card-body d-flex justify-content-center align-items-center">
                        <div id="scatterPlot" class="chart"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Table Section -->
        <div class="row">
            <div class="col-md-12 mb-4">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0">Data Table</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="scrollable-table" style="max-height: 400px; overflow-y: auto;">
                            <table class="table table-striped table-hover mb-0">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Year</th>
                                        <th>Topic</th>
                                        <th>Region</th>
                                        <th>Intensity</th>
                                        <th>Likelihood</th>
                                    </tr>
                                </thead>
                                <tbody id="dataTableBody">
                                    <!-- Rows will be dynamically populated using JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-dark text-center py-3">
            <p>&copy; 2024 Your Company. All rights reserved.</p>
        </footer>
    </div>

    <!-- Bootstrap and jQuery scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>
